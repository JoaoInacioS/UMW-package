% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fits.R
\name{fit_RQUMW}
\alias{fit_RQUMW}
\title{Fit the Regression Quantile Unit-Modified Weibull (RQ-UMW) Model}
\usage{
fit_RQUMW(
  f,
  data = NULL,
  tau = 0.5,
  link_mu = "logit",
  method = "BFGS",
  start.theta = NULL,
  printmodel = T
)
}
\arguments{
\item{f}{A symbolic formula describing the model structure. The response
variable must lie in the open interval \eqn{(0,1)}. Additional model
components may be specified using the \code{|} operator.}

\item{data}{Optional data frame containing the variables in the model.}

\item{tau}{Quantile level in \eqn{(0,1)} to be modeled. Default is \code{0.5}.}

\item{link_mu}{Character string or function specifying the link for the
\eqn{\mu} parameter. Can be "logit", "probit", "cauchit", "cloglog", "loglog",
or a user-supplied function implementing the desired link. Default is \code{"logit"}.}

\item{method}{Optimization method used by \code{\link[stats]{optim}}.
Possible values are \code{"Nelder-Mead"}, \code{"BFGS"},
\code{"CG"} and \code{"SANN"}.}

\item{start.theta}{Optional numeric vector of initial values for the
optimization algorithm.}

\item{printmodel}{Logical indicating whether a model summary should be
printed to the console. Default is \code{TRUE}.}
}
\value{
A list containing the following components:
\itemize{
\item \strong{formula}: Model formula supplied by the user.
\item \strong{data}: Data frame used for fitting the model.
\item \strong{y}: Numeric vector of observed responses.
\item \strong{X, W, Z}: Design matrices for the \eqn{\mu}, \eqn{\gamma},
and \eqn{\lambda} parameters, respectively. Each column represents a covariate.
\item \strong{pars}: Estimated parameter vector.
\item \strong{coef}: Matrix with parameter estimates, standard errors,
z-statistics, p-values, and significance codes.
\item \strong{fitted}: Vector of fitted values.
\item \strong{residuals}: Quantile residuals.
\item \strong{loglik}: Log-likelihood of the fitted model.
\item \strong{metrics}: List containing information criteria (AIC, BIC, AICc),
the generalized \eqn{R^2}, and the Andersonâ€“Darling test for normality of
the quantile residuals.
\item \strong{convergence}: Logical indicating whether the optimization
algorithm converged successfully.
\item \strong{n}: Number of observations.
\item \strong{method}: Optimization method used.
\item \strong{alpha}: Estimated \eqn{\alpha} parameter of the UMW distribution.
\item \strong{quantile}: Quantile level \eqn{\tau} used in the model.
\item \strong{link}: List of all link functions used in the model:
\code{g_mu, g_gamma, g_lambda} and their inverses
\code{ginv_mu, ginv_gamma, ginv_lambda}.
\item \strong{loglik0}: Log-likelihood of the null model (without regression structure).
\item \strong{outer.iter}: Number of iterations performed by the optimizer.
\item \strong{df.residual}: Residual degrees of freedom.
\item \strong{st.res}: Standardized residual variance.
\item \strong{zeta_hat}: Linear predictor for the \eqn{\mu} parameter (\eqn{X \beta}).
\item \strong{hessian}: Hessian matrix of the log-likelihood at the estimated parameters.
\item \strong{measures}: Numeric vector of error measures computed on the fitted values:
Mean Squared Error (MSE), Root Mean Squared Error (RMSE),
Mean Absolute Error (MAE), and Mean Absolute Percentage Error (MAPE).
}
}
\description{
Fits the RQ-UMW model by numerically maximizing the
log-likelihood function. The score vector and Hessian matrix are computed
analytically.
}
\examples{
library(UMW)

set.seed(34)
y<-runif(100, 0.01, 0.99)
X1<-rnorm(100)
X2<-rnorm(100)
data <- data.frame(y = y, X1 = X1, X2 = X2)

fit1 <- fit_RQUMW(f = y ~ . | 1 | 1, data = data, tau = 0.5,
                  method = "BFGS",link_mu = "logit")

fit2 <- fit_RQUMW(y ~ ., data = data, tau = 0.25,
                  method = "CG",link_mu = "probit")

fit3 <- fit_RQUMW(y ~ X1 + X2 -1, data = NULL, tau = 0.75,
                  method = "Nelder-Mead",link_mu = "cloglog")

fit4 <- fit_RQUMW(f = y ~ X1-1| 1 | X1, data = NULL, tau = 0.5,
                  method = "BFGS",link_mu = "loglog")

fit5 <- fit_RQUMW(f = y ~ X1 |X2-1|X1, data = NULL, tau = 0.35,
                  method = "BFGS",link_mu = "cauchit")

}
